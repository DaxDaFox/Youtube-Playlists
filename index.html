<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>YouTube Playlists</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  #status { margin-bottom: 10px; }
  #playlists { margin-top: 20px; }
  .playlist-btn { display: block; margin: 5px 0; }
</style>
</head>
<body>

<h1>YouTube Playlists</h1>
<div id="status">Not signed in.</div>
<button id="signinBtn">Sign in with Google</button>
<div id="playlists"></div>

<!-- Load the Google API platform library -->
<script src="https://apis.google.com/js/api.js"></script>
<script>
  const CLIENT_ID = '656269912892-ah9lfkjdh8e6q40hrmh4ogurc336gqqr.apps.googleusercontent.com'; // <-- Replace this
  let accessToken = '';

  // Initialize the Google API client
  function initClient() {
    gapi.load('auth2', () => {
      window.auth2 = gapi.auth2.init({
        client_id: CLIENT_ID,
        scope: 'https://www.googleapis.com/auth/youtube.force-ssl'
      });
    });
  }

  // Sign in handler
 document.getElementById('signinBtn').onclick = () => {
    auth2.signIn().then(user => {
      const authResponse = user.getAuthResponse();
      accessToken = authResponse.access_token;
      document.getElementById('status').innerText = 'Signed in!';
      fetchPlaylists();
    }).catch(error => {
      alert('Sign-in failed: ' + error.error);
    });
  };

  // Fetch playlists function
  async function fetchPlaylists() {
    console.log('Fetching playlists...');
    try {
      const response = await fetch(
        'https://www.googleapis.com/youtube/v3/playlists?part=snippet&mine=true',
        {
          headers: {
            Authorization: 'Bearer ' + accessToken
          }
        }
      );
      const data = await response.json();
      console.log('Playlists data:', data);
      if (data.error) {
        alert('Error: ' + data.error.message);
        return;
      }
      displayPlaylists(data.items);
    } catch (err) {
      alert('Fetch error: ' + err);
    }
  }

  // Display playlists as buttons
function displayPlaylists(playlists) {
  const container = document.getElementById('playlists');
  container.innerHTML = '';

  if (!playlists || playlists.length === 0) {
    container.innerText = 'No playlists found.';
    return;
  }

  playlists.forEach(pl => {
    const btn = document.createElement('button');
    btn.className = 'playlist-btn';
    btn.innerText = pl.snippet.title;
    btn.onclick = () => {
      alert('You clicked playlist: ' + pl.snippet.title);
      // Here you can implement adding videos, etc.
    };
    container.appendChild(btn);
  });
}

  // Load the API client and auth2 library
gapi.load('client:auth2', initClient);
</script>
</body>
</html>
